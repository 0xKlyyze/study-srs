<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Chart.js (Keep if overview section remains) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Add to your HTML file head section -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Gridstack.js -->
    <script src="https://cdn.jsdelivr.net/npm/gridstack@10.1.2/dist/gridstack-all.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/gridstack@10.1.2/dist/gridstack.min.css" rel="stylesheet"/>
    <!-- Gridstack Default Theme (Optional but helpful) -->
    <link href="https://cdn.jsdelivr.net/npm/gridstack@10.1.2/dist/gridstack-extra.min.css" rel="stylesheet"/>

        <!-- Core Styles (From Phase 1) -->
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/base.css">
    
        <!-- Layout & Component Styles (To be created in later phases) -->
        <link rel="stylesheet" href="css/layout.css">
        <link rel="stylesheet" href="css/components/button.css">
        <link rel="stylesheet" href="css/components/modal.css">
        <link rel="stylesheet" href="css/components/context-menu.css">
        <link rel="stylesheet" href="css/components/floating-pill.css">
        <link rel="stylesheet" href="css/components/dashboard-controls.css">
        <link rel="stylesheet" href="css/components/overview-section.css">
        <link rel="stylesheet" href="css/components/grid-items.css">
        <link rel="stylesheet" href="css/components/chapter-item.css">
        <link rel="stylesheet" href="css/components/group-widget.css">
        <link rel="stylesheet" href="css/components/skeleton.css">

    <title>Kaizen - Dashboard View</title>
    <style>

/* --- Keyframes for Glow Animation (Filter Based) --- */
@keyframes pulse-glow-filter {
    0% { filter: drop-shadow(0 0 3px rgba(91, 192, 222, 0.5)); }
    50% { filter: drop-shadow(0 0 7px rgba(123, 208, 232, 0.7)); } /* Brighter cyan/blue */
    100% { filter: drop-shadow(0 0 3px rgba(91, 192, 222, 0.5)); }
}



/* --- Study Options Popup --- */
.study-options-popup {
    position: absolute;
    bottom: calc(100% + 6px); /* Closer gap */
    right: 0;
    width: 145px; /* Fixed width maybe? */
    background-color: #232e44dc; /* Match context menu */
    border-radius: 18px; /* Match context menu */
    border: 1px solid #4a5a7e; /* Match context menu */
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3); /* Match context menu */
    padding: 8px; /* Tighter padding */
    display: flex;
    flex-direction: column;
    gap: 8px;
    z-index: 960;
    opacity: 0;
    transform: translateY(8px);
    visibility: hidden;
    transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s;
}
.study-options-popup.visible {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
}

/* Focused Study Button inside Popup */
.study-options-popup .action-button.focused-study-button {
    /* Style similarly to V4.5 action button */
    padding: 8px 12px;
    font-size: 0.9em;
    border-radius: 14px;
    background-color: var(--success-green);
    box-shadow: 0 2px 5px rgba(0,0,0,0.2); /* Simple shadow */
    color: #fff;
    border: 1px solid rgba(255,255,255,0.1);
    font-weight: 500; /* Normal weight */
    transition: background-color 0.2s ease, transform 0.15s ease, box-shadow 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    white-space: nowrap;
    width: 100%;
    text-align: center;
}
.study-options-popup .action-button.focused-study-button:hover {
    background-color: #4cae4c;
    transform: translateY(-1px);
    box-shadow: 0 3px 7px rgba(0,0,0,0.3);
}
.study-options-popup .action-button.focused-study-button.is-selecting-chapters {
     background-color: var(--warning-orange);
     box-shadow: 0 2px 5px rgba(0,0,0,0.2);
}
.study-options-popup .action-button.focused-study-button.is-selecting-chapters:hover {
     background-color: #ec971f;
     box-shadow: 0 3px 7px rgba(0,0,0,0.3);
}

/* Batch Size inside Popup */
.study-options-popup .batch-size-control {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    flex-direction: row;
    border-top: 0px solid rgba(74, 90, 126, 0.3); /* Lighter separator */
    padding-top: 6px;
    margin-top: 4px;
}
.study-options-popup .batch-size-label {
    font-size: 0.85em;
    margin: 0;
    color: var(--text-secondary);
}
.study-options-popup .batch-size-input {
    background-color: var(--tertiary-bg);
    border: 1px solid rgba(74, 90, 126, 0.5); /* Subtle border */
    color: var(--text-primary);
    border-radius: 8px;
    padding: 4px 6px; /* Tighter padding */
    font-size: 0.9em;
    width: 45px; /* Slightly narrower */
    text-align: center;
    outline: none;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.study-options-popup .batch-size-input { -moz-appearance: textfield; }
.study-options-popup .batch-size-input::-webkit-outer-spin-button,
.study-options-popup .batch-size-input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
.study-options-popup .batch-size-input:focus {
     border-color: var(--accent-blue);
     box-shadow: 0 0 4px rgba(91, 192, 222, 0.3);
}
/* --- Specific Modal Styles --- */


/* Responsiveness */
@media (max-width: 900px) {
        .overview-section { grid-template-columns: 1fr; gap: 30px; }
}
@media (max-width: 768px) {
        body { padding: 15px; }
        .management-container { padding: 20px; }
        .heatmap-grid { grid-template-columns: repeat(auto-fill, minmax(35px, 1fr)); gap: 4px; }
        /* Review heatmap cells are already small */
        .floating-study-pill.extended {
max-width: 98vw; /* Even more width on smaller screens */
padding: 6px 10px; /* Slightly more padding for touch */
}

/* Make components more compact when space is limited */
.floating-study-pill.extended .extended-controls {
gap: 8px; /* Reduce gap between elements */
}

/* Ensure batch size control remains visible */
.batch-size-control {
min-width: 85px; /* Ensure minimum width for the control */
}
}

/* ================================== */
/*       RESPONSIVENESS              */
/* ================================== */
@media (max-width: 1200px) {
/* Adjust gridstack columns? Maybe let it wrap naturally */
}
@media (max-width: 900px) {
.overview-section { grid-template-columns: 1fr; }
/* GRIDSTACK TODO: Change grid columns if needed */
/* this.gridInstance?.column(3); ? */
}
@media (max-width: 768px) {
body { padding: 10px; }
.management-container { padding: 15px; }
.dashboard-controls { flex-direction: column; align-items: stretch; gap: 15px;}
.sort-controls { justify-content: space-between; }
.tag-pills-container { padding-bottom: 10px; /* More space for scrollbar */ }
.selection-toolbar { flex-direction: column; align-items: flex-start; }
}

    @media (max-width: 480px) {
        .chapter-grid { grid-template-columns: 1fr; }
        .action-button { width: 90%; font-size: 1em; padding: 12px 20px; }
        .heatmap-grid { grid-template-columns: repeat(auto-fill, minmax(30px, 1fr)); } /* Smaller cells on mobile */
        .floating-study-pill {
bottom: 15px; /* Position closer to bottom on mobile */

        /* GRIDSTACK TODO: Change grid columns */
/* this.gridInstance?.column(1); ? */
.group-chapter-area.layout-card { grid-template-columns: 1fr; } /* Single column card layout */
.chapter-list-style.size-medium-list,
.chapter-list-style.size-wide-list {
    /* Simplify list views on very small screens */
    .card-stats-new { display: none; }}
}

.study-stats {
gap: 8px; /* Tighter spacing in stats */
}

.material-switcher-pill {
min-width: calc(var(--container-min-width-compressed) * 0.9); /* Slightly more compact */
}

    }

    </style>
</head>
<body>

    <div class="management-container" id="managementContainer">

       <!-- ================================== -->
        <!--      OVERVIEW SECTION (Keeping)     -->
        <!-- ================================== -->
        <div class="overview-section">
             <div class="heatmaps-column">
                <!-- Review Activity -->
                
                <div class="section-container review-activity-section">
                    <h2 class="section-title">Recent Review Activity</h2>
                    <div class="review-heatmap-grid" style="position: relative;">
                        <!-- Content Added by JS -->
                         <p class="loading-text">Loading Activity...</p>
                    </div>
               </div>
            </div>
            <!-- Review Schedule -->
            <div class="section-container review-schedule-section">
                <h2 class="section-title">Review Schedule</h2>
                <div id="timelineContainer" class="review-schedule-graph" style="position: relative;">
                <canvas id="timelineCanvas"></canvas>
                <p id="timelineStatus" class="graph-status" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: #a0a0c0; display: none; text-align: center; padding: 0 10px;"></p>
                <p class="loading-text">Loading Schedule...</p>
                </div>
            </div>
        </div>
        <div id="heatmap-tooltip" class="global-tooltip" role="tooltip"></div>


 
       <!-- ================================== -->
        <!--      TOP CONTROLS SECTION         -->
        <!-- ================================== -->
        <div class="dashboard-controls"> <!-- Main Flex Container -->

            <!-- Sorting Controls -->
            <div id="sortControlsContainer" class="sort-controls">
                <label for="sortField">Sort :</label>
                <select id="sortField" name="sortField">
                    <option value="name">Name</option>
                    <option value="createdAt">Date Added</option>
                    <option value="stats.mastery">Mastery</option>
                    <option value="stats.cardCount">Card Count</option>
                    <option value="stats.totalDueCards">Due Count</option>
                    <option value="stats.lastUpdatedAt">Last Updated</option>
                </select>
                <!-- NEW: Sort Order Buttons -->
                <div class="sort-order-buttons">
                     <button id="sortAscButton" class="sort-order-btn" data-order="asc" title="Sort Ascending">
                        <svg fill="#ffffff" height="200px" width="200px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15.993 15.993" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M12.703,4.285l-4-3.992c-0.391-0.39-1.022-0.39-1.413,0l-4,3.992l1.413,1.416l2.294-2.289v12.581h2V3.412l2.293,2.289 L12.703,4.285z"></path> </g> </g></svg>                     </button>
                     <button id="sortDescButton" class="sort-order-btn" data-order="desc" title="Sort Descending">
                        <svg fill="#ffffff" height="200px" width="200px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 15.993 15.993" xml:space="preserve" transform="rotate(180)"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M12.703,4.285l-4-3.992c-0.391-0.39-1.022-0.39-1.413,0l-4,3.992l1.413,1.416l2.294-2.289v12.581h2V3.412l2.293,2.289 L12.703,4.285z"></path> </g> </g></svg>                     </button>
                </div>
                 <!-- REMOVED: <select id="sortOrder">...</select> -->
            </div>

            <!-- Tag Section (Scrollable Pills + Add Button) -->
            <div class="tag-section">
                <!-- Add Tag Button & Input Wrapper -->
                <!-- Scrollable Pills -->
                <div id="tagPillsContainer" class="tag-pills-container scrollable">
                     <!-- Pills Added by JS -->
                     <span class="loading-text-small">Loading filters...</span>
                </div>
                <div id="addTagInlineWrapper" class="add-tag-inline-wrapper">
                    <button id="addTagButton" class="icon-button add-tag-button" title="Add New Tag">
                         <svg class="add-icon" viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg>
                         <!-- No Cancel Icon Needed Here -->
                    </button>
                    <input type="text" id="addTagInput" class="add-tag-input" placeholder="New tag name..." style="display: none;">
               </div>
           </div>

             <!-- Action Buttons (Separate) -->
             <div class="dashboard-actions">
                 <button id="selectChaptersButton" class="action-button select-chapters-button" data-action="toggle-select">
                      <!-- Icon? --> Select Chapters
                 </button>
             </div>

        </div><!-- End .dashboard-controls -->

        <!-- Selection Toolbar (Shown by JS when selection mode active) -->
        <div id="selectionToolbar" class="selection-toolbar" style="display: none;">
            <span id="selectionCount">0 items selected</span>
            <div class="selection-actions">
                <button id="tagSelectedButton" title="Add Tags to Selected Chapters" disabled>Tag</button>
                <button id="pinSelectedButton" title="Pin/Unpin Selected Chapters" disabled>Pin/Unpin</button>
                <button id="suspendSelectedButton" title="Suspend/Unsuspend Selected Chapters" disabled>Suspend/Unsuspend</button>
                <button id="groupSelectedButton" title="Add Selected Chapters to Group" disabled>Group</button>
                                <!-- REMOVED: confirmGroupSelectionButton is no longer needed with the new flow -->
                <button id="deleteSelectedButton" title="Delete Selected Chapters" disabled class="danger">Delete</button>
            </div>
        </div>


        <!-- ================================== -->
        <!--      DASHBOARD GRID SECTION       -->
        <!-- ================================== -->
        <div id="dashboardGrid" class="grid-stack">
             <!-- Gridstack items (groups and ungrouped chapters) added by JS -->
             <!-- Initial Loading/Error Message Area -->
             <p class="loading-text">Loading dashboard...</p>
        </div>

    </div> <!-- End .management-container -->

    <!-- ================================== -->
    <!--         CONTEXT MENUS              -->
    <!-- ================================== -->

    <!-- Chapter Context Menu -->
    <div id="chapterContextMenu" class="context-menu" style="display: none;">
        <ul>
            <li data-action="rename"><span class="menu-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg>
            </span> Rename Chapter</li>
            <li data-action="pin"><span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                    <path d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12M8.8,14L10,12.8V4H14V12.8L15.2,14H8.8Z" />
                </svg>
            </span> Pin Chapter</li>            
            <li data-action="suspend"><span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M9,9H15V15H9" />
                </svg>
            </span> Suspend Chapter</li>            
            <li data-action="add-tag"><span class="menu-icon"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M21.07 10.3L15.07 4.29996C14.93 4.15996 14.74 4.07996 14.54 4.07996H3C2.59 4.07996 2.25 4.41996 2.25 4.82996V12.71C2.25 12.91 2.33 13.1 2.47 13.24L8.47 19.23C8.91 19.67 9.49 19.91 10.11 19.91C10.73 19.91 11.32 19.67 11.75 19.23L11.97 19.01C12.01 19.09 12.05 19.17 12.12 19.23C12.57 19.68 13.17 19.91 13.76 19.91C14.35 19.91 14.95 19.68 15.41 19.23L21.06 13.58C21.96 12.68 21.96 11.21 21.06 10.3H21.07ZM10.7 18.17C10.54 18.33 10.34 18.41 10.12 18.41C9.9 18.41 9.69 18.32 9.54 18.17L3.75 12.4V5.57996H10.57L16.35 11.36C16.67 11.68 16.67 12.2 16.35 12.52L10.7 18.17ZM20.01 12.52L14.36 18.17C14.04 18.49 13.51 18.49 13.19 18.17C13.12 18.1 13.05 18.06 12.96 18.02L17.4 13.58C18.3 12.67 18.3 11.2 17.4 10.3L12.68 5.57996H14.22L20 11.36C20.32 11.68 20.32 12.2 20 12.52H20.01ZM8.25 8.49996C8.25 9.18996 7.69 9.74996 7 9.74996C6.31 9.74996 5.75 9.18996 5.75 8.49996C5.75 7.80996 6.31 7.24996 7 7.24996C7.69 7.24996 8.25 7.80996 8.25 8.49996Z" fill="#ffffff"></path> </g></svg></span> Manage Tags...</li>
            <li data-action="delete"><span class="menu-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="22" height="22"><path d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"></path></svg>
            </span> Delete Chapter</li>
        </ul>
   </div>

   <!-- Group Context Menu -->
   <div id="groupContextMenu" class="context-menu" style="display: none;">
        <ul>
            <li data-action="rename"><span class="menu-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"></path></svg>
            </span> Rename Group</li>
            <li data-action="toggle-layout"><span class="menu-icon"><svg fill="#ffffff" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M9,14 L20,14 L20,9 L9,9 L9,14 Z M9,15 L9,20 L18.5,20 C19.3284271,20 20,19.3284271 20,18.5 L20,15 L9,15 Z M8,20 L8,9 L4,9 L4,18.5 C4,19.3284271 4.67157288,20 5.5,20 L8,20 Z M20,8 L20,5.5 C20,4.67157288 19.3284271,4 18.5,4 L5.5,4 C4.67157288,4 4,4.67157288 4,5.5 L4,8 L20,8 Z M3,5.5 C3,4.11928813 4.11928813,3 5.5,3 L18.5,3 C19.8807119,3 21,4.11928813 21,5.5 L21,18.5 C21,19.8807119 19.8807119,21 18.5,21 L5.5,21 C4.11928813,21 3,19.8807119 3,18.5 L3,5.5 Z"></path> </g></svg></span> Toggle Layout</li>
            <li data-action="set-sort"><span class="menu-icon"><svg fill="#ffffff" height="200px" width="200px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 301.219 301.219" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <path d="M159.365,23.736v-10c0-5.523-4.477-10-10-10H10c-5.523,0-10,4.477-10,10v10c0,5.523,4.477,10,10,10h139.365 C154.888,33.736,159.365,29.259,159.365,23.736z"></path> <path d="M130.586,66.736H10c-5.523,0-10,4.477-10,10v10c0,5.523,4.477,10,10,10h120.586c5.523,0,10-4.477,10-10v-10 C140.586,71.213,136.109,66.736,130.586,66.736z"></path> <path d="M111.805,129.736H10c-5.523,0-10,4.477-10,10v10c0,5.523,4.477,10,10,10h101.805c5.523,0,10-4.477,10-10v-10 C121.805,134.213,117.328,129.736,111.805,129.736z"></path> <path d="M93.025,199.736H10c-5.523,0-10,4.477-10,10v10c0,5.523,4.477,10,10,10h83.025c5.522,0,10-4.477,10-10v-10 C103.025,204.213,98.548,199.736,93.025,199.736z"></path> <path d="M74.244,262.736H10c-5.523,0-10,4.477-10,10v10c0,5.523,4.477,10,10,10h64.244c5.522,0,10-4.477,10-10v-10 C84.244,267.213,79.767,262.736,74.244,262.736z"></path> <path d="M298.29,216.877l-7.071-7.071c-1.875-1.875-4.419-2.929-7.071-2.929c-2.652,0-5.196,1.054-7.072,2.929l-34.393,34.393 V18.736c0-5.523-4.477-10-10-10h-10c-5.523,0-10,4.477-10,10v225.462l-34.393-34.393c-1.876-1.875-4.419-2.929-7.071-2.929 c-2.652,0-5.196,1.054-7.071,2.929l-7.072,7.071c-3.904,3.905-3.904,10.237,0,14.142l63.536,63.536 c1.953,1.953,4.512,2.929,7.071,2.929c2.559,0,5.119-0.976,7.071-2.929l63.536-63.536 C302.195,227.113,302.195,220.781,298.29,216.877z"></path> </g> </g></svg></span> Set Chapter Sort...</li>
            <li data-action="change-color"><span class="menu-icon"><svg fill="#ffffff" viewBox="0 0 32 32" id="icon" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><defs><style>.cls-1{fill:none;}</style></defs><title>color palette</title><circle cx="10" cy="12" r="2"></circle><circle cx="16" cy="9" r="2"></circle><circle cx="22" cy="12" r="2"></circle><circle cx="23" cy="18" r="2"></circle><circle cx="19" cy="23" r="2"></circle><path d="M16.54,2A14,14,0,0,0,2,16a4.82,4.82,0,0,0,6.09,4.65l1.12-.31A3,3,0,0,1,13,23.24V27a3,3,0,0,0,3,3A14,14,0,0,0,30,15.46,14.05,14.05,0,0,0,16.54,2Zm8.11,22.31A11.93,11.93,0,0,1,16,28a1,1,0,0,1-1-1V23.24a5,5,0,0,0-5-5,5.07,5.07,0,0,0-1.33.18l-1.12.31A2.82,2.82,0,0,1,4,16,12,12,0,0,1,16.47,4,12.18,12.18,0,0,1,28,15.53,11.89,11.89,0,0,1,24.65,24.32Z"></path><rect id="_Transparent_Rectangle_" data-name="<Transparent Rectangle>" class="cls-1" width="32" height="32"></rect></g></svg></span> Change Color...</li>
            <li data-action="ungroup"><span class="menu-icon"><svg fill="#000000" width="800px" height="800px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21,18.28V11.72A2,2,0,1,0,18.28,9H15V5.72A2,2,0,1,0,12.28,3H5.72A2,2,0,1,0,3,5.72v6.56A2,2,0,1,0,5.72,15H9v3.28A2,2,0,1,0,11.72,21h6.56A2,2,0,1,0,21,18.28ZM8,10a2,2,0,0,0,1,1.72V13H5.72A1.91,1.91,0,0,0,5,12.28V5.72A1.91,1.91,0,0,0,5.72,5h6.56a1.91,1.91,0,0,0,.72.72V9H11.72A2,2,0,0,0,8,10Zm5,1v1.28a1.91,1.91,0,0,0-.72.72H11V11.72a1.91,1.91,0,0,0,.72-.72Zm6,7.28a1.91,1.91,0,0,0-.72.72H11.72a1.91,1.91,0,0,0-.72-.72V15h1.28A2,2,0,1,0,15,12.28V11h3.28a1.91,1.91,0,0,0,.72.72Z" fill="#fff" style=""></path></svg></span> Ungroup Chapters</li>
        </ul>
   </div>

       <!-- ================================== -->
    <!--              MODALS                -->
    <!-- ================================== -->
    <div id="confirmationModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <span id="confirmModalIcon" class="modal-icon warning">
                    <!-- Warning/Alert SVG -->
                    <svg viewBox="0 0 24 24"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"></path></svg>
                </span>
                <h3 id="confirmModalTitle" class="modal-title">Confirmation</h3>
            </div>
            <p id="confirmModalMessage" class="modal-message">Are you sure?</p>
            <div id="confirmModalActions" class="modal-actions">
                <!-- Buttons added dynamically by JS -->
            </div>
        </div>
    </div>

    <!-- NEW: Error Modal Structure (Similar to Confirmation) -->
    <div id="errorModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                 <span id="errorModalIcon" class="modal-icon error">
                    <!-- Error/Cross SVG -->
                    <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
                 </span>
                 <h3 id="errorModalTitle" class="modal-title">Error</h3>
            </div>
            <p id="errorModalMessage" class="modal-message">An error occurred.</p>
            <div id="errorModalActions" class="modal-actions">
                 <button class="modal-button secondary" data-action="close">OK</button>
            </div>
        </div>
    </div>

    <!-- NEW: Info/Success Modal Structure -->
<div id="infoModal" class="modal-overlay"> <!-- Unique ID -->
    <div class="modal-content info-modal"> <!-- Specific class -->
        <div class="modal-header">
            <span id="infoModalIcon" class="modal-icon info"> <!-- Icon class -->
                <!-- Info or Checkmark SVG -->
                 <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"></path></svg> <!-- Example: Checkmark -->
                 <!-- Info Icon Alt: <svg viewBox="0 0 24 24"><path d="M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"></path></svg> -->
            </span>
            <h3 id="infoModalTitle" class="modal-title">Information</h3> <!-- Title ID -->
        </div>
        <p id="infoModalMessage" class="modal-message">Info message.</p> <!-- Message ID -->
        <div id="infoModalActions" class="modal-actions"> <!-- Actions ID -->
            <button class="modal-button secondary" data-action="close">OK</button> <!-- Single OK button -->
        </div>
    </div>
</div>

  <!-- Tag Management Modal -->
  <div id="tagManagementModal" class="modal-overlay">
    <div class="modal-content tag-modal">
         <div class="modal-header"><span class="modal-icon tag-icon"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M21.07 10.3L15.07 4.29996C14.93 4.15996 14.74 4.07996 14.54 4.07996H3C2.59 4.07996 2.25 4.41996 2.25 4.82996V12.71C2.25 12.91 2.33 13.1 2.47 13.24L8.47 19.23C8.91 19.67 9.49 19.91 10.11 19.91C10.73 19.91 11.32 19.67 11.75 19.23L11.97 19.01C12.01 19.09 12.05 19.17 12.12 19.23C12.57 19.68 13.17 19.91 13.76 19.91C14.35 19.91 14.95 19.68 15.41 19.23L21.06 13.58C21.96 12.68 21.96 11.21 21.06 10.3H21.07ZM10.7 18.17C10.54 18.33 10.34 18.41 10.12 18.41C9.9 18.41 9.69 18.32 9.54 18.17L3.75 12.4V5.57996H10.57L16.35 11.36C16.67 11.68 16.67 12.2 16.35 12.52L10.7 18.17ZM20.01 12.52L14.36 18.17C14.04 18.49 13.51 18.49 13.19 18.17C13.12 18.1 13.05 18.06 12.96 18.02L17.4 13.58C18.3 12.67 18.3 11.2 17.4 10.3L12.68 5.57996H14.22L20 11.36C20.32 11.68 20.32 12.2 20 12.52H20.01ZM8.25 8.49996C8.25 9.18996 7.69 9.74996 7 9.74996C6.31 9.74996 5.75 9.18996 5.75 8.49996C5.75 7.80996 6.31 7.24996 7 7.24996C7.69 7.24996 8.25 7.80996 8.25 8.49996Z" fill="#ffffff"></path> </g></svg>
         </span><h3 class="modal-title">Manage Tags</h3></div>
         <div class="modal-body">
              <div class="create-tag-section">
                   <label for="newTagNameInput">New Tag:</label>
                   <input type="text" id="newTagNameInput" placeholder="Enter new tag name">
                   <button id="createTagButton" class="modal-button primary small">Create</button>
              </div>
              <div class="existing-tags-section">
                   <h4>Existing Tags:</h4>
                   <ul id="existingTagsList" class="tags-list">
                        <!-- Tags loaded by JS -->
                        <li>Loading tags...</li>
                   </ul>
              </div>
         </div>
         <div class="modal-actions">
              <button class="modal-button secondary" data-action="close">Close</button>
         </div>
    </div>
</div>

    <!-- Set Group Sort Preference Modal -->
    <div id="groupSortModal" class="modal-overlay">
        <div class="modal-content group-sort-modal">
             <div class="modal-header"><span class="modal-icon sort-icon"><!-- Sort SVG --></span><h3 class="modal-title">Set Group Chapter Sort</h3></div>
             <div class="modal-body">
                  <div class="form-group inline">
                      <label for="groupSortField">Sort chapters by:</label>
                      <select id="groupSortField" name="groupSortField">
                          <option value="name">Name</option>
                          <option value="createdAt">Date Added</option>
                          <option value="stats.mastery">Mastery</option>
                          <option value="stats.cardCount">Card Count</option>
                          <option value="stats.totalDueCards">Due Count</option>
                          <option value="stats.lastUpdatedAt">Last Updated</option>
                      </select>
                  </div>
                   <div class="form-group inline">
                       <label for="groupSortOrder">Order:</label>
                       <select id="groupSortOrder" name="groupSortOrder">
                           <option value="asc">Ascending</option>
                           <option value="desc">Descending</option>
                       </select>
                   </div>
             </div>
             <div class="modal-actions">
                  <button class="modal-button secondary" type="button" data-action="close">Cancel</button>
                  <button id="groupSortConfirmButton" class="modal-button primary" type="button">Set Preference</button>
             </div>
        </div>
   </div>

<!-- NEW: Chapter Tag Selector Modal -->
     <!-- Chapter Tag Selector Modal -->
     <div id="tagSelectorModal" class="modal-overlay">
        <div class="modal-content tag-selector-modal">
             <div class="modal-header"><span class="modal-icon tag-icon"><!-- Tag SVG --></span><h3 class="modal-title">Select Tags</h3></div> <!-- Title updated dynamically -->
             <div class="modal-body">
                  <p class="tag-selector-instruction">Select tags to apply:</p> <!-- Added instruction -->
                  <ul id="tagSelectorList" class="tags-list checkboxes">
                       <!-- Checkboxes loaded by JS -->
                       <li>Loading tags...</li>
                  </ul>
             </div>
             <div class="modal-actions">
                  <button class="modal-button secondary" type="button" data-action="close">Cancel</button>
                  <button id="tagSelectorConfirmButton" class="modal-button primary" type="button">Apply Tags</button>
             </div>
        </div>
    </div>

<!-- NEW: Group Color Picker Modal -->
     <!-- Group Color Picker Modal -->
     <div id="groupColorPickerModal" class="modal-overlay">
        <div class="modal-content color-picker-modal">
             <div class="modal-header"><span class="modal-icon color-icon"><!-- Color Palette SVG --></span><h3 class="modal-title">Choose Group Color</h3></div>
             <div class="modal-body" style="display: flex; justify-content: center; align-items: center; padding: 20px 0;"> <!-- Centered -->
                  <input type="color" id="groupColorPickerInput" value="#4a5a7e">
             </div>
             <div class="modal-actions">
                  <button class="modal-button secondary" type="button" data-action="close">Cancel</button>
                  <!-- Confirm handled by input 'change' event -->
                  <!-- <button id="colorPickerConfirmButton" class="modal-button primary" type="button">Set Color</button> -->
             </div>
        </div>
   </div>


    <!-- ================================== -->
    <!--      FLOATING STUDY PILL           -->
    <!-- ================================== -->
<div class="floating-study-pill" id="floatingStudyPill">

    <!-- 1. Material Switcher -->
    <div class="material-switcher-pill" id="pillMaterialSwitcher">
        <div class="material-switcher-pill-inner">
             <!-- Real Tabs added by JS -->
        </div>
         <!-- Skeleton Structure -->
         <div class="material-switcher-skeleton">
             <div class="skeleton skeleton-material-tab"></div>
             <!-- Add more if you want to show >1 skeleton tab -->
             <!-- <div class="skeleton skeleton-material-tab"></div> -->
             <!-- <div class="skeleton skeleton-material-tab"></div> -->
         </div>
    </div>

        <!-- 2. Study Stats -->
        <div class="pill-stats">
            <!-- Real Stat Boxes -->
            <div class="stat-box new-cards-stat" title="New cards available today">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M13 7H11v4H7v2h4v4h2v-4h4v-2h-4V7zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>
                 </svg>
                <span class="stat-value" id="pillNewCardsCount">-</span>
           </div>
            <div class="stat-box due-cards-stat" title="Cards due for review">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
               </svg>
                 <span class="stat-value" id="pillDueCardsCount">-</span>
            </div>

             <!-- Skeleton Structure -->
             <div class="pill-stats-skeleton">
                 <div class="skeleton skeleton-stat-box"></div>
                 <div class="skeleton skeleton-stat-box"></div>
             </div>
        </div>

        <!-- 3. Study Button Wrapper (Button + Dropdown Trigger) -->
    <div class="pill-study-actions">
        <button class="action-button study-due-button" id="pillStudyDueButton">
            <!-- Add SVG Icon here -->
            <svg width="100" height="32" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg">
      
                <!-- Card 4 (Deepest in the stack) -->
                <!-- Further offset (x=8, y=2), increased negative rotation -->
                <rect 
                  x="8" y="2" 
                  width="20" height="24" 
                  rx="3" ry="3" 
                  fill="none" 
                  stroke="white" 
                  stroke-width="1.5" 
                  transform="rotate(-12 18 14)" /> 
                  <!-- Rotation center: x=8 + width/2=18, y=2 + height/2=14 -->
              
                <!-- Card 3 -->
                <!-- Original "Back Card", now the third from front -->
                <!-- Position (x=6, y=4), standard negative rotation -->
                 <rect 
                  x="6" y="4" 
                  width="20" height="24" 
                  rx="3" ry="3" 
                  fill="none" 
                  stroke="white" 
                  stroke-width="1.5" 
                  transform="rotate(-6 16 16)" /> 
                  <!-- Rotation center: x=6 + width/2=16, y=4 + height/2=16 -->
              
                <!-- Card 2 & Text '1' Group (Front Card Group) -->
                <!-- Rotated slightly positive -->
                <g transform="rotate(4 13 13)"> 
                   <!-- Rotation center: x=4 + width/2=13, y=2 + height/2=13 -->
              
                  <!-- Card 2 Outline (Front Card Outline) -->
                  <rect 
                    x="4" y="2" 
                    width="18" height="22" 
                    rx="3" ry="3" 
                    fill="none" 
                    stroke="white" 
                    stroke-width="1.5" />
              
              
                </g>
              </svg>
            <span>Study Due</span> <!-- Keep text -->
        </button>
        <button class="study-options-trigger" id="pillOptionsTrigger" aria-label="Show study options" aria-haspopup="true" aria-expanded="false">
            <!-- Dropdown Arrow SVG -->
            <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"></path></svg>
        </button>

        <!-- Study Options Popup (Hidden by default) -->
        <div class="study-options-popup" id="studyOptionsPopup" role="menu" style="display: none;">
             <!-- Focused Study Button (State managed by JS) -->
            <button class="action-button focused-study-button" id="pillStartFocusedButton" role="menuitem">
                Select Chapters... <!-- Initial Text -->
            </button>
             <!-- Batch Size Input -->
            <div class="batch-size-control" role="presentation">
                <label for="pillReviewBatchSize" class="batch-size-label">Batch Size:</label>
                <input type="number" id="pillReviewBatchSize" name="review-batch-size" class="batch-size-input" min="1" step="5" value="20" title="Max cards per focused session">
            </div>
        </div>
    </div>

</div>
<!-- END OF FLOATING STUDY PILL COMPONENT -->


<!-- NEW: Material Context Menu Structure -->
<div id="materialContextMenu" class="context-menu" style="display: none;">
    <ul>
        <li data-action="settings">
            <span class="menu-icon" title="Settings">
                <!-- Gear Icon SVG -->
                <svg viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></svg>
            </span> Material Settings
        </li>
        <li data-action="set-default">
            <span class="menu-icon" title="Set Default">
                <!-- Star or Pin Icon SVG -->
                 <svg viewBox="0 0 24 24"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></svg>
            </span> Set as Default
        </li>
    </ul>
</div>

<!-- NEW: Material Settings Modal Structure -->
<div id="materialSettingsModal" class="modal-overlay">
    <div class="modal-content settings-modal"> <!-- Add specific class -->
        <div class="modal-header">
            <span class="modal-icon">
                <!-- Re-use Gear Icon -->
                 <svg viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"></path></svg>
            </span>
            <h3 id="settingsModalTitle" class="modal-title">Material Settings</h3>
        </div>

        <!-- Form Content -->
        <form id="materialSettingsForm" onsubmit="return false;"> <!-- Prevent default form submission -->
            <input type="hidden" id="settingsEditMaterialName" value=""> <!-- Store name being edited -->

            <!-- Section 1: General -->
            <fieldset class="settings-section">
                <legend>General</legend>
                <div class="form-group">
                    <label for="settingsMaterialName">Material Name:</label>
                    <input type="text" id="settingsMaterialName" name="materialName" required>
                </div>
            </fieldset>

            <!-- Section 2: Study Options -->
            <fieldset class="settings-section">
                <legend>Study Options</legend>
                <div class="form-group inline"> <!-- Inline group -->
                    <label for="settingsDailyLimit">Daily New Limit:</label>
                    <input type="number" id="settingsDailyLimit" name="dailyLimit" min="0" step="1" required>
                </div>
                 <div class="form-group inline">
                    <label for="settingsDefaultBatchSize">Default Batch Size:</label>
                    <input type="number" id="settingsDefaultBatchSize" name="defaultBatchSize" min="1" step="5" required>
                </div>
            </fieldset>

<!-- Section 3: SRS Algorithm Parameters -->
<fieldset class="settings-section">
    <legend>SRS Algorithm</legend>
    <p class="settings-description">Fine-tune scheduling intervals (Advanced).</p>
     <div class="form-group">
         <label for="settingsAlgoLearningSteps">Learning Steps (days, comma-separated):</label>
         <input type="text" id="settingsAlgoLearningSteps" name="algoLearningSteps" pattern="^(\d+(\.\d+)?)(,\s*\d+(\.\d+)?)*$">
     </div>
     <div class="form-group inline">
         <label for="settingsAlgoGraduationInterval">Graduation Interval (days):</label>
         <input type="number" id="settingsAlgoGraduationInterval" name="algoGraduationInterval" min="1" step="1" required>
     </div>
    <div class="form-group inline">
         <label for="settingsAlgoLapseInterval">Lapse Interval (days):</label>
         <input type="number" id="settingsAlgoLapseInterval" name="algoLapseInterval" min="0" step="0.1" required> <!-- Allow fractions for lapse -->
     </div>
     <div class="form-group inline">
         <label for="settingsAlgoEasyBonus">Easy Bonus Factor:</label>
         <input type="number" id="settingsAlgoEasyBonus" name="algoEasyBonus" min="1.0" step="0.05" required> <!-- Factor, not % -->
     </div>
    <div class="form-group inline">
         <label for="settingsAlgoMinEase">Min Ease Factor:</label>
         <input type="number" id="settingsAlgoMinEase" name="algoMinEase" min="1.0" step="0.05" required>
     </div>
     <div class="form-group inline">
         <label for="settingsAlgoDefaultEase">Default Ease Factor:</label>
         <input type="number" id="settingsAlgoDefaultEase" name="algoDefaultEase" min="1.0" step="0.05" required>
     </div>
     <div class="form-group inline">
         <label for="settingsAlgoHardMultiplier">Hard Interval Multiplier:</label>
         <input type="number" id="settingsAlgoHardMultiplier" name="algoHardMultiplier" min="1.0" step="0.05" required>
     </div>
     <div class="form-group inline">
         <label for="settingsAlgoMaxInterval">Max Interval (days):</label>
         <input type="number" id="settingsAlgoMaxInterval" name="algoMaxInterval" min="1" step="1" required>
     </div>
    <div class="form-group inline">
         <label for="settingsAlgoEaseAdjLapse">Ease Adj. Lapse:</label>
         <input type="number" id="settingsAlgoEaseAdjLapse" name="algoEaseAdjLapse" step="0.01" required> <!-- Can be negative -->
     </div>
    <div class="form-group inline">
         <label for="settingsAlgoEaseAdjHard">Ease Adj. Hard:</label>
         <input type="number" id="settingsAlgoEaseAdjHard" name="algoEaseAdjHard" step="0.01" required> <!-- Can be negative -->
     </div>
    <div class="form-group inline">
         <label for="settingsAlgoEaseAdjEasy">Ease Adj. Easy:</label>
         <input type="number" id="settingsAlgoEaseAdjEasy" name="algoEaseAdjEasy" step="0.01" required> <!-- Can be negative -->
     </div>
</fieldset>

 <!-- Section 4: SRS Thresholds (Correct Input Types/Labels) -->
<fieldset class="settings-section">
    <legend>SRS Thresholds</legend>
     <p class="settings-description">Define card state transitions.</p>
     <div class="form-group inline">
         <label for="settingsThresholdLearningReps">Learning Reps:</label>
         <input type="number" id="settingsThresholdLearningReps" name="thresholdLearningReps" min="1" step="1" required>
     </div>
    <div class="form-group inline">
         <label for="settingsThresholdMasteredReps">Mastered Reps:</label>
         <input type="number" id="settingsThresholdMasteredReps" name="thresholdMasteredReps" min="1" step="1" required>
     </div>
      <div class="form-group inline">
         <label for="settingsThresholdMasteredEase">Mastered Ease Factor:</label> <!-- Factor -->
         <input type="number" id="settingsThresholdMasteredEase" name="thresholdMasteredEase" min="1.0" step="0.05" required>
     </div>
     <div class="form-group inline">
         <label for="settingsThresholdCriticalEase">Critical Ease Factor:</label> <!-- Factor -->
         <input type="number" id="settingsThresholdCriticalEase" name="thresholdCriticalEase" min="1.0" step="0.05" required>
     </div>
</fieldset>
</form>

        <div id="settingsModalActions" class="modal-actions">
             <button id="settingsCancelButton" class="modal-button secondary" type="button">Cancel</button>
             <button id="settingsSaveButton" class="modal-button primary" type="button">Save Changes</button>
        </div>
    </div>
</div>
    <!-- At the end of the body tag -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script type="module" src="./js/views/chapterFoldersView.js"></script>
</body>
</html>